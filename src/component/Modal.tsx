// This is a skeleton starter React component generated by Plasmic.
// This file is owned by you, feel free to edit as you see fit.
import React, { useState } from 'react';
import {
  PlasmicModal,
  DefaultModalProps,
} from './plasmic/shared/PlasmicModal';
import { useForm } from 'react-hook-form';
import { saveUser, ISaveUser } from 'module/store';

const options = [
  { value: 'Marcus Ellison' },
  { value: 'Tim Schindler' },
  { value: 'Victor Tan' },
];

interface ModalProps extends DefaultModalProps {
  organizationName: string;
  users: string[];
  organizationDescription: string;
  setLogin: any;
}

function Modal(props: ModalProps) {
  const {
    organizationName,
    organizationDescription,
    setLogin,
  } = props;
  const { handleSubmit } = useForm<any>();
  const [user, setUser] = useState('');

  const handleLogin = () => {
    const userObj: ISaveUser = {
      userId: user,
      organizationId: organizationName,
    };
    saveUser(userObj);
    setLogin(userObj);
  };

  return (
    <PlasmicModal
      organizationName={organizationName}
      organizationDescription={organizationDescription}
      welcomeForm={{
        onSubmit: handleSubmit(handleLogin),
      }}
      selectUserButton={{
        type: 'submit',
      }}
      selectUserInput={{
        options: options,
        onChange: (user: string) => {
          setUser(user);
        },
      }}
    />
  );
}

export default Modal;
