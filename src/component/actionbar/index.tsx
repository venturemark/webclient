// This is a skeleton starter React component generated by Plasmic.
// This file is owned by you, feel free to edit as you see fit.
import React, { useState } from "react";
import {
  PlasmicActionBar,
  DefaultActionBarProps,
} from "component/plasmic/shared/PlasmicActionBar";
import ComposeEditor from "component/editor/compose";
import CircularProgress from "@material-ui/core/CircularProgress";
import { EditorShape } from "component/editor/compose";

interface ActionBarProps extends DefaultActionBarProps {
  errorMessage: string;
  progress: number;
  editorShape: EditorShape;
  setEditorShape: React.Dispatch<React.SetStateAction<EditorShape>>;
}

function ActionBar(props: ActionBarProps) {
  const { errorMessage, progress, editorShape, setEditorShape } = props;

  const MIN = 0;
  const MAX = 240;
  const normalize = (value: number) => ((value - MIN) * 100) / (MAX - MIN);

  const [isActive, setIsActive] = useState(false);
  const [timelineSelected, setTimelineSelected] = useState(false);

  return (
    <PlasmicActionBar
      root={{
        onClick: () => setIsActive(true),
      }}
      error={errorMessage ? "hasError" : undefined}
      text={normalize(progress) > 0 ? "hasText" : undefined}
      timelineSelected={timelineSelected}
      selectTimelineContainer={{
        onClick: () => setTimelineSelected(true),
      }}
      errorMessage={errorMessage}
      isActive={isActive}
      textContainer={{
        render: () => (
          <ComposeEditor
            editorShape={editorShape}
            setEditorShape={setEditorShape}
          />
        ),
      }}
    />
  );
}

export default ActionBar;
