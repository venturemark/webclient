// This is a skeleton starter React component generated by Plasmic.
// This file is owned by you, feel free to edit as you see fit.
import React from 'react';
import {
  PlasmicUpdate,
  DefaultUpdateProps,
} from 'component/plasmic/shared/PlasmicUpdate';
import { Node } from 'slate';
import { useTimelines } from 'module/hook/timeline';
import { ITimeline, ITimelineQuery } from 'module/interface/timeline';

interface UpdateProps extends DefaultUpdateProps {
  text: Node[];
  id: string;
  organizationName: string;
  timelineId: string;
  userName: string;
  date: string;
}

function Update(props: UpdateProps) {
  const {
    text,
    id,
    organizationName,
    timelineId,
    userName,
    date,
  } = props;

  const timelineSearch: ITimelineQuery = {
    userId: userName,
    organizationId: organizationName,
  };

  const { data: timelinesData } = useTimelines(timelineSearch);
  const timelines = timelinesData ?? [];

  const timelineName = timelines.filter(
    (timeline: ITimeline) => timeline.id === timelineId,
  )[0].name;

  return (
    <PlasmicUpdate
      updateContent={{
        text: text,
        id: id,
        organizationName: organizationName,
        userName: userName,
        timelineName: timelineName,
        date: date,
      }}
    />
  );
}

export default Update;
